from topologic_sort import topologic_sort
from graph import Graph
from decimal import Decimal

def minimum_path(G, s, dest):
	dist = {}
	d = {}

	for v in G.get_nodes(): 
		dist.update({ G.get_nodes()[v].get_content() : Decimal('Infinity') })
		d.update({ G.get_nodes()[v].get_content() : None })

	dist[s] = 0

	topologic_sorted = topologic_sort(G)
	topologic_sorted_size = len(topologic_sorted)
	print('Topologic sorted: ', topologic_sorted)

	begin = -1
	for x in range(0, topologic_sorted_size):
		if topologic_sorted[x] == s: begin = x

	if begin == -1: return 'Origin vertice not found'

	for i in range(begin, topologic_sorted_size):
		exist_node = G.exist_node(topologic_sorted[i])
		if exist_node == None: continue

		vertices_adj = G.get_nodes()[exist_node].get_neighbors()

		for vertice in vertices_adj:
			if (dist[topologic_sorted[i]] + vertices_adj[vertice]) < dist[G.get_nodes()[vertice].get_content()]:
				dist[G.get_nodes()[vertice].get_content()] = dist[topologic_sorted[i]] + vertices_adj[vertice]
				d[G.get_nodes()[vertice].get_content()] = topologic_sorted[i] 
    
	k = 0
	solution = []
	while d[dest] != None:
		solution.append(dest)
		dest = d[dest]
	solution.append(s)

	print('\n\nPath: ', list(reversed(solution)), '\n\n')
	print('Dist: ', dist)

	return solution

graph_base = Graph()


#vertices = ['r', 's', 't', 'x', 'y', 'z']

#

#vertices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]

#tuples = {(0, 1, 10), (0, 2, 14), (0, 3, 6), (0, 5, 28), (0, 6, 30), (0, 7, 9), (0, 8, 29), (0, 9, 9), (0, 10, 26), (0, 14, 24), (1, 2, 27), (1, 3, 8), (1, 4, 27), (1, 6, 26), (1, 7, 13), (1, 8, 3), (1, 12, 9), (1, 13, 29), (2, 3, 20), (2, 4, 23), (2, 5, 15), (2, 7, 29), (2, 8, 14), (2, 9, 8), (2, 10, 10), (2, 11, 15), (2, 13, 21), (2, 14, 18), (3, 5, 15), (3, 6, 4), (3, 8, 5), (3, 9, 15), (3, 10, 20), (3, 11, 18), (3, 13, 13), (3, 14, 12), (4, 5, 6), (4, 6, 25), (4, 8, 9), (4, 9, 28), (4, 10, 28), (4, 11, 1), (4, 12, 18), (4, 13, 15), (4, 14, 16), (5, 6, 11), (5, 8, 24), (5, 9, 8), (5, 10, 5), (5, 11, 11), (5, 12, 30), (5, 13, 8), (6, 7, 25), (6, 10, 19), (6, 11, 18), (6, 12, 20), (6, 13, 19), (7, 8, 23), (7, 10, 17), (7, 11, 30), (7, 12, 13), (7, 14, 25), (8, 9, 28), (8, 10, 1), (9, 10, 28), (9, 11, 11), (9, 12, 10), (9, 13, 15), (9, 14, 20), (10, 12, 10), (10, 14, 16), (11, 14, 6), (12, 13, 10), (12, 14, 1), (13, 14, 12)}

vertices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]

tuples = { (0, 9, 6), (0, 12, 39), (0, 13, 89), (0, 15, 68), (0, 22, 46), (0, 24, 37), (0, 26, 59), (0, 27, 27), (0, 29, 67), (0, 30, 63), (0, 31, 95), (0, 32, 54), (0, 33, 44), (0, 36, 20), (0, 37, 26), (0, 39, 43), (0, 42, 26), (0, 43, 43), (0, 45, 14), (0, 47, 38), (0, 48, 25), (0, 49, 98), (1, 4, 79), (1, 11, 57), (1, 12, 15), (1, 13, 53), (1, 16, 94), (1, 17, 91), (1, 20, 70), (1, 21, 26), (1, 22, 36), (1, 26, 2), (1, 27, 48), (1, 29, 13), (1, 34, 58), (1, 35, 88), (1, 36, 66), (1, 38, 32), (1, 40, 39), (1, 41, 84), (1, 45, 43), (1, 47, 40), (1, 49, 30), (2, 3, 24), (2, 8, 11), (2, 9, 39), (2, 10, 27), (2, 16, 53), (2, 17, 41), (2, 18, 20), (2, 21, 15), (2, 26, 22), (2, 27, 17), (2, 29, 59), (2, 33, 98), (2, 36, 80), (2, 38, 22), (2, 41, 72), (2, 42, 12), (3, 6, 62), (3, 7, 28), (3, 9, 2), (3, 10, 60), (3, 11, 55), (3, 12, 9), (3, 13, 100), (3, 17, 93), (3, 19, 29), (3, 21, 3), (3, 22, 34), (3, 25, 36), (3, 32, 80), (3, 33, 97), (3, 38, 9), (3, 42, 54), (3, 43, 42), (3, 44, 26), (3, 46, 36), (3, 49, 18), (4, 5, 52), (4, 8, 54), (4, 9, 48), (4, 10, 59), (4, 11, 71), (4, 12, 36), (4, 13, 67), (4, 17, 38), (4, 19, 90), (4, 22, 12), (4, 24, 22), (4, 29, 4), (4, 31, 100), (4, 33, 34), (4, 34, 11), (4, 35, 29), (4, 37, 51), (4, 40, 83), (4, 42, 99), (4, 45, 48), (4, 47, 30), (5, 6, 45), (5, 7, 36), (5, 9, 68), (5, 12, 12), (5, 14, 20), (5, 15, 13), (5, 16, 18), (5, 17, 16), (5, 20, 72), (5, 23, 100), (5, 24, 57), (5, 26, 13), (5, 27, 72), (5, 29, 84), (5, 31, 54), (5, 33, 86), (5, 34, 15), (5, 36, 100), (5, 39, 8), (5, 40, 34), (5, 42, 67), (5, 47, 41), (5, 48, 23), (5, 49, 48), (6, 17, 43), (6, 19, 37), (6, 22, 95), (6, 25, 25), (6, 27, 54), (6, 29, 45), (6, 31, 41), (6, 32, 28), (6, 34, 40), (6, 40, 90), (6, 43, 16), (6, 45, 86), (6, 49, 61), (7, 9, 13), (7, 10, 96), (7, 11, 19), (7, 13, 72), (7, 14, 87), (7, 16, 43), (7, 19, 42), (7, 20, 52), (7, 21, 14), (7, 24, 26), (7, 26, 41), (7, 27, 45), (7, 31, 8), (7, 36, 17), (7, 39, 91), (7, 41, 100), (7, 44, 99), (7, 46, 27), (8, 18, 61), (8, 21, 96), (8, 24, 89), (8, 26, 42), (8, 27, 20), (8, 28, 25), (8, 30, 32), (8, 32, 11), (8, 34, 33), (8, 35, 36), (8, 37, 43), (8, 40, 91), (8, 42, 82), (8, 44, 57), (8, 46, 77), (8, 49, 25), (9, 10, 10), (9, 12, 12), (9, 13, 78), (9, 16, 85), (9, 17, 57), (9, 18, 53), (9, 20, 30), (9, 21, 13), (9, 22, 42), (9, 25, 99), (9, 26, 55), (9, 27, 43), (9, 30, 90), (9, 34, 36), (9, 37, 34), (9, 40, 93), (9, 41, 55), (9, 42, 28), (9, 43, 7), (9, 47, 47), (10, 12, 47), (10, 14, 74), (10, 15, 75), (10, 16, 82), (10, 17, 25), (10, 18, 40), (10, 23, 46), (10, 24, 48), (10, 25, 4), (10, 29, 30), (10, 31, 37), (10, 33, 45), (10, 36, 26), (10, 37, 49), (10, 40, 8), (10, 42, 71), (10, 44, 55), (10, 45, 61), (10, 46, 81), (10, 47, 43), (11, 12, 51), (11, 13, 77), (11, 17, 55), (11, 19, 21), (11, 25, 52), (11, 28, 13), (11, 30, 56), (11, 31, 24), (11, 36, 53), (11, 38, 95), (11, 41, 69), (11, 42, 32), (11, 43, 79), (11, 44, 44), (11, 45, 94), (11, 47, 88), (11, 48, 12), (12, 13, 17), (12, 15, 45), (12, 16, 26), (12, 21, 51), (12, 23, 34), (12, 24, 48), (12, 28, 51), (12, 29, 12), (12, 30, 8), (12, 31, 38), (12, 33, 71), (12, 34, 81), (12, 35, 22), (12, 36, 38), (12, 38, 23), (12, 39, 49), (12, 43, 68), (12, 45, 58), (12, 48, 90), (12, 49, 52), (13, 16, 82), (13, 17, 23), (13, 22, 97), (13, 26, 14), (13, 28, 80), (13, 33, 34), (13, 36, 86), (13, 39, 41), (13, 41, 37), (13, 45, 58), (14, 17, 33), (14, 22, 29), (14, 23, 33), (14, 24, 28), (14, 26, 57), (14, 30, 25), (14, 32, 85), (14, 33, 35), (14, 34, 28), (14, 36, 8), (14, 37, 43), (14, 39, 61), (14, 42, 95), (14, 44, 49), (14, 47, 87), (14, 48, 100), (14, 49, 55), (15, 18, 55), (15, 19, 87), (15, 20, 57), (15, 22, 12), (15, 23, 76), (15, 26, 47), (15, 28, 50), (15, 29, 88), (15, 30, 10), (15, 33, 34), (15, 36, 99), (15, 41, 66), (15, 49, 79), (16, 21, 28), (16, 24, 20), (16, 28, 38), (16, 29, 77), (16, 33, 36), (16, 37, 31), (16, 40, 84), (16, 42, 14), (16, 44, 63), (16, 48, 96), (17, 20, 54), (17, 21, 31), (17, 24, 25), (17, 26, 25), (17, 28, 85), (17, 29, 4), (17, 36, 8), (17, 37, 22), (17, 44, 28), (17, 45, 18), (17, 46, 19), (17, 47, 86), (17, 48, 68), (18, 22, 82), (18, 25, 39), (18, 28, 15), (18, 29, 88), (18, 33, 22), (18, 35, 62), (18, 36, 99), (18, 37, 6), (18, 39, 85), (18, 43, 82), (18, 44, 12), (18, 46, 83), (19, 20, 95), (19, 23, 15), (19, 26, 74), (19, 27, 37), (19, 35, 85), (19, 36, 30), (19, 37, 52), (19, 38, 16), (19, 42, 41), (19, 43, 11), (19, 47, 20), (19, 49, 94), (20, 21, 39), (20, 22, 46), (20, 24, 52), (20, 25, 78), (20, 28, 57), (20, 29, 67), (20, 30, 54), (20, 31, 18), (20, 33, 94), (20, 34, 20), (20, 39, 74), (20, 41, 45), (20, 44, 84), (20, 47, 4), (20, 48, 92), (21, 24, 75), (21, 27, 78), (21, 30, 14), (21, 31, 81), (21, 33, 3), (21, 34, 60), (21, 36, 82), (21, 37, 44), (21, 43, 79), (21, 44, 16), (21, 45, 71), (21, 48, 28), (22, 29, 79), (22, 32, 32), (22, 33, 44), (22, 40, 57), (22, 41, 92), (22, 46, 90), (22, 47, 49), (22, 48, 43), (23, 26, 59), (23, 27, 38), (23, 28, 84), (23, 32, 62), (23, 35, 71), (23, 38, 81), (23, 40, 93), (23, 43, 60), (23, 44, 97), (23, 47, 24), (23, 48, 14), (23, 49, 37), (24, 26, 73), (24, 34, 75), (24, 35, 92), (24, 36, 13), (24, 38, 19), (24, 40, 68), (24, 41, 2), (24, 42, 48), (24, 44, 49), (24, 48, 51), (25, 27, 26), (25, 28, 5), (25, 32, 76), (25, 34, 87), (25, 35, 45), (25, 39, 40), (25, 40, 23), (25, 41, 50), (25, 42, 89), (25, 44, 92), (25, 45, 33), (25, 49, 58), (26, 27, 85), (26, 29, 5), (26, 30, 28), (26, 33, 29), (26, 35, 79), (26, 37, 99), (26, 39, 84), (26, 40, 32), (26, 42, 99), (26, 44, 26), (26, 47, 17), (26, 48, 49), (26, 49, 19), (27, 28, 94), (27, 35, 13), (27, 36, 100), (27, 38, 53), (27, 41, 78), (27, 44, 28), (27, 46, 21), (27, 47, 37), (28, 29, 45), (28, 30, 13), (28, 32, 2), (28, 33, 68), (28, 34, 37), (28, 36, 10), (28, 41, 95), (28, 47, 95), (29, 34, 64), (29, 36, 25), (29, 39, 61), (29, 41, 76), (29, 42, 38), (29, 43, 92), (29, 48, 96), (30, 33, 30), (30, 34, 57), (30, 37, 36), (30, 40, 89), (30, 41, 36), (30, 43, 50), (30, 44, 60), (30, 46, 81), (30, 47, 44), (30, 49, 48), (31, 35, 41), (31, 37, 24), (31, 40, 44), (31, 43, 84), (31, 44, 45), (31, 46, 89), (31, 47, 28), (32, 33, 19), (32, 34, 72), (32, 38, 73), (32, 42, 80), (32, 45, 93), (33, 36, 45), (33, 39, 6), (33, 45, 79), (33, 46, 35), (33, 47, 5), (33, 48, 13), (34, 36, 55), (34, 37, 86), (34, 38, 12), (34, 42, 56), (34, 43, 22), (34, 48, 84), (34, 49, 61), (35, 36, 3), (35, 37, 9), (35, 41, 2), (35, 44, 82), (35, 45, 41), (35, 46, 41), (35, 48, 86), (36, 39, 7), (36, 40, 77), (36, 43, 58), (36, 45, 77), (36, 47, 54), (36, 48, 30), (37, 38, 20), (37, 40, 80), (37, 42, 9), (37, 44, 89), (37, 46, 71), (38, 39, 73), (38, 40, 65), (38, 41, 43), (38, 42, 94), (38, 43, 34), (38, 46, 4), (38, 48, 54), (39, 44, 76), (40, 43, 98), (40, 46, 19), (40, 47, 34), (40, 49, 8), (41, 42, 20), (41, 44, 20), (41, 45, 15), (41, 47, 74), (42, 45, 8), (42, 47, 45), (42, 49, 34), (43, 44, 86), (43, 46, 4), (43, 48, 69), (44, 48, 63), (46, 47, 18), (46, 48, 93), (46, 49, 23)}

#vertices = [0,1,2,3,4,5,6,7]

#tuples = { (0,4,1), (1,5,1), (2,6,3), (3,5,9), (3,7,1), (5,7,6) }

graph_base.build_graph(vertices, tuples)

minimum_path(graph_base, 2, 48)


